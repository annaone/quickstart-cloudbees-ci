:xrefstyle: short

# Architecture
Deploying this Partner Solution for a new virtual private cloud (VPC) with default parameters builds the following CloudBees CI environment in the AWS Cloud.

![Partner Solution architecture for CloudBees CI on AWS](https://d1.awsstatic.com/partner-network/QuickStart/datasheets/cloudbees-core-architecture-on-aws.f458a95880735d9329884e9ea2673c85a56abd9b.png)

As shown in <<Figure 1>>, the Partner Solution sets up the following:

* A highly available architecture that spans three Availability Zones.*
* A VPC configured with three public and three private subnets (one public and one 
private subnet in each Availability Zone).*
* In the public subnets:
** Managed NAT gateways to allow outbound internet access for resources in the private subnets.*
** A Linux bastion host in an Auto Scaling group, to allow inbound Secure Shell (SSH) access to the Amazon EKS nodes in the private subnets.*
* In the private subnets, the following Amazon EKS nodes in Auto Scaling groups:
** Three CloudBees CI master nodes.
** Three CloudBees CI regular agent nodes.
** Three CloudBees CI Spot agent nodes. These nodes are in an Auto Scaling group that is configured for multiple instance types.
* https://helm.sh/[Helm^] and https://kubernetes.io/docs/reference/kubectl/overview/[kubectl^] installed and configured on the bastion host.
* CloudBees CI installed on Amazon EKS as a Kubernetes StatefulSet.
* An Amazon Elastic File System (Amazon EFS) file system and an https://docs.aws.amazon.com/eks/latest/userguide/efs-csi.html[EFS CSI Driver^] for 
Multi-AZ file storage. You can configure the Partner Solution to use Amazon Elastic Block 
Store (Amazon EBS) instead of Amazon EFS. For more information, see the Data 
storage options section.

> **Note**
> *The template that deploys the Quick Start into an existing VPC skips the components marked by asterisks and prompts you for your existing VPC configuration.

## Helm
> **Note**
> In March 2020, the Quick Start was updated to use https://helm.sh/[Helm^] as the means to install CloudBees CI into Amazon EKS. The use of Helm provides greater compatibility with AWS CloudFormation and reduced code maintenance. The manifests are now encapsulated by the CloudBees CI Helm chart, and the Partner Solution points to a version of the Helm chart, which is released by CloudBees.

